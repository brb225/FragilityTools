En2 <- 700
niters <- 50
exact_fragility <- matrix(nrow=niters,ncol=2)
exact_fragilitytools <- matrix(nrow=niters,ncol=2)
for (i in 1:niters) {
if (i%%10==5) print(i)
x <- rbinom(1, n1, p1)
y <- rbinom(1, n2, p2)
n1 <- rpois(1,En1)
n2 <- rpois(1,En2)
mat <- matrix(nrow=2, c(x,y,n1-x,n2-y), dimnames=list(1:2,1:2))
# fragility
ptm <- proc.time()
out.fr <- fragility::frag.study(x,n1,y,n2,methods='Fisher')
time.fr <- proc.time()-ptm
exact_fragility[i,] <-c(out.fr$FI[[1]], time.fr[[1]])
# fragilitytools
ptm <- proc.time()
out.frt <- bin.fi(mat, alg='exact')
time.frt <- proc.time()-ptm
exact_fragilitytools[i,] <-c(out.frt$FI[[1]], time.frt[[1]])
}
sum(exact_fragility[,1]!=abs(exact_fragilitytools[,1]))
plot(exact_fragilitytools[,2], exact_fragility[,2]-exact_fragilitytools[,2])
devtools::load_all()
library(fragility)
p1 <- .2
p2 <- .15
En1 <- 500
En2 <- 700
niters <- 50
exact_fragility <- matrix(nrow=niters,ncol=2)
exact_fragilitytools <- matrix(nrow=niters,ncol=2)
for (i in 1:niters) {
if (i%%10==5) print(i)
x <- rbinom(1, n1, p1)
y <- rbinom(1, n2, p2)
n1 <- rpois(1,En1)
n2 <- rpois(1,En2)
mat <- matrix(nrow=2, c(x,y,n1-x,n2-y), dimnames=list(1:2,1:2))
# fragility
ptm <- proc.time()
out.fr <- fragility::frag.study(x,n1,y,n2,methods='Fisher')
time.fr <- proc.time()-ptm
exact_fragility[i,] <-c(out.fr$FI[[1]], time.fr[[1]])
# fragilitytools
ptm <- proc.time()
out.frt <- bin.fi(mat, alg='exact')
time.frt <- proc.time()-ptm
exact_fragilitytools[i,] <-c(out.frt$FI[[1]], time.frt[[1]])
}
sum(exact_fragility[,1]!=abs(exact_fragilitytools[,1]))
plot(exact_fragilitytools[,2], exact_fragility[,2]-exact_fragilitytools[,2])
summary(exact_fragility[,2]-exact_fragilitytools[,2])
devtools::load_all()
library(fragility)
p1 <- .2
p2 <- .15
En1 <- 500
En2 <- 700
niters <- 100
exact_fragility <- matrix(nrow=niters,ncol=2)
exact_fragilitytools <- matrix(nrow=niters,ncol=2)
for (i in 1:niters) {
if (i%%10==5) print(i)
x <- rbinom(1, n1, p1)
y <- rbinom(1, n2, p2)
n1 <- rpois(1,En1)
n2 <- rpois(1,En2)
mat <- matrix(nrow=2, c(x,y,n1-x,n2-y), dimnames=list(1:2,1:2))
# fragility
ptm <- proc.time()
out.fr <- fragility::frag.study(x,n1,y,n2,methods='Fisher')
time.fr <- proc.time()-ptm
exact_fragility[i,] <-c(out.fr$FI[[1]], time.fr[[1]])
# fragilitytools
ptm <- proc.time()
out.frt <- bin.fi(mat, alg='exact')
time.frt <- proc.time()-ptm
exact_fragilitytools[i,] <-c(out.frt$FI[[1]], time.frt[[1]])
}
sum(exact_fragility[,1]!=abs(exact_fragilitytools[,1]))
plot(exact_fragilitytools[,2], exact_fragility[,2]-exact_fragilitytools[,2])
summary(exact_fragility[,2]-exact_fragilitytools[,2])
devtools::load_all()
library(fragility)
p1 <- .1
p2 <- .4
En1 <- 500
En2 <- 700
niters <- 100
exact_fragility <- matrix(nrow=niters,ncol=2)
exact_fragilitytools <- matrix(nrow=niters,ncol=2)
for (i in 1:niters) {
if (i%%10==5) print(i)
x <- rbinom(1, n1, p1)
y <- rbinom(1, n2, p2)
n1 <- rpois(1,En1)
n2 <- rpois(1,En2)
mat <- matrix(nrow=2, c(x,y,n1-x,n2-y), dimnames=list(1:2,1:2))
# fragility
ptm <- proc.time()
out.fr <- fragility::frag.study(x,n1,y,n2,methods='Fisher')
time.fr <- proc.time()-ptm
exact_fragility[i,] <-c(out.fr$FI[[1]], time.fr[[1]])
# fragilitytools
ptm <- proc.time()
out.frt <- bin.fi(mat, alg='exact')
time.frt <- proc.time()-ptm
exact_fragilitytools[i,] <-c(out.frt$FI[[1]], time.frt[[1]])
}
sum(exact_fragility[,1]!=abs(exact_fragilitytools[,1]))
plot(exact_fragilitytools[,2], exact_fragility[,2]-exact_fragilitytools[,2])
summary(exact_fragility[,2]-exact_fragilitytools[,2])
devtools::load_all()
library(fragility)
p1 <- .1
p2 <- .4
En1 <- 500
En2 <- 700
niters <- 100
exact_fragility <- matrix(nrow=niters,ncol=2)
exact_fragilitytools <- matrix(nrow=niters,ncol=2)
for (i in 1:niters) {
print(i)
x <- rbinom(1, n1, p1)
y <- rbinom(1, n2, p2)
n1 <- rpois(1,En1)
n2 <- rpois(1,En2)
mat <- matrix(nrow=2, c(x,y,n1-x,n2-y), dimnames=list(1:2,1:2))
# fragility
ptm <- proc.time()
out.fr <- fragility::frag.study(x,n1,y,n2,methods='Fisher')
time.fr <- proc.time()-ptm
exact_fragility[i,] <-c(out.fr$FI[[1]], time.fr[[1]])
# fragilitytools
ptm <- proc.time()
out.frt <- bin.fi(mat, alg='exact')
time.frt <- proc.time()-ptm
exact_fragilitytools[i,] <-c(out.frt$FI[[1]], time.frt[[1]])
}
sum(exact_fragility[,1]!=abs(exact_fragilitytools[,1]))
plot(exact_fragilitytools[,2], exact_fragility[,2]-exact_fragilitytools[,2])
ggplot2::qplot((exact_fragilitytools[,2]-exact_fragility[,2])/exact_fragility[,2])
summary(exact_fragility[,2]-exact_fragilitytools[,2])
devtools::load_all()
library(fragility)
p1 <- .1
p2 <- .4
En1 <- 500
En2 <- 700
niters <- 100
exact_fragility <- matrix(nrow=niters,ncol=2)
exact_fragilitytools <- matrix(nrow=niters,ncol=2)
for (i in 1:niters) {
print(i)
x <- rbinom(1, n1, p1)
y <- rbinom(1, n2, p2)
n1 <- rpois(1,En1)
n2 <- rpois(1,En2)
mat <- matrix(nrow=2, c(x,y,n1-x,n2-y), dimnames=list(1:2,1:2))
# fragility
ptm <- proc.time()
out.fr <- fragility::frag.study(x,n1,y,n2,methods='Fisher')
time.fr <- proc.time()-ptm
exact_fragility[i,] <-c(out.fr$FI[[1]], time.fr[[1]])
print('done fragility')
# fragilitytools
ptm <- proc.time()
out.frt <- bin.fi(mat, alg='exact')
time.frt <- proc.time()-ptm
exact_fragilitytools[i,] <-c(out.frt$FI[[1]], time.frt[[1]])
}
sum(exact_fragility[,1]!=abs(exact_fragilitytools[,1]))
plot(exact_fragilitytools[,2], exact_fragility[,2]-exact_fragilitytools[,2])
ggplot2::qplot((exact_fragilitytools[,2]-exact_fragility[,2])/exact_fragility[,2])
summary(exact_fragility[,2]-exact_fragilitytools[,2])
devtools::load_all()
library(fragility)
p1 <- .1
p2 <- .4
En1 <- 500
En2 <- 700
niters <- 100
exact_fragility <- matrix(nrow=niters,ncol=2)
exact_fragilitytools <- matrix(nrow=niters,ncol=2)
for (i in 1:niters) {
print(i)
n1 <- rpois(1,En1)
n2 <- rpois(1,En2)
x <- rbinom(1, n1, p1)
y <- rbinom(1, n2, p2)
mat <- matrix(nrow=2, c(x,y,n1-x,n2-y), dimnames=list(1:2,1:2))
# fragility
ptm <- proc.time()
out.fr <- fragility::frag.study(x,n1,y,n2,methods='Fisher')
time.fr <- proc.time()-ptm
exact_fragility[i,] <-c(out.fr$FI[[1]], time.fr[[1]])
print('done fragility')
# fragilitytools
ptm <- proc.time()
out.frt <- bin.fi(mat, alg='exact')
time.frt <- proc.time()-ptm
exact_fragilitytools[i,] <-c(out.frt$FI[[1]], time.frt[[1]])
}
sum(exact_fragility[,1]!=abs(exact_fragilitytools[,1]))
plot(exact_fragilitytools[,2], exact_fragility[,2]-exact_fragilitytools[,2])
ggplot2::qplot((exact_fragilitytools[,2]-exact_fragility[,2])/exact_fragility[,2])
summary(exact_fragility[,2]-exact_fragilitytools[,2])
cbind(exact_fragility, exact_fragilitytools)
cbind(exact_fragility, exact_fragilitytools)[1:11,]
?bin.fi
devtools::load_all()
library(fragility)
p1 <- .1
p2 <- .4
En1 <- 500
En2 <- 700
niters <- 100
exact_fragility <- matrix(nrow=niters,ncol=2)
exact_fragilitytools <- matrix(nrow=niters,ncol=2)
for (i in 1:niters) {
print(i)
n1 <- rpois(1,En1)
n2 <- rpois(1,En2)
x <- rbinom(1, n1, p1)
y <- rbinom(1, n2, p2)
mat <- matrix(nrow=2, c(x,y,n1-x,n2-y), dimnames=list(1:2,1:2))
# fragility
ptm <- proc.time()
out.fr <- fragility::frag.study(x,n1,y,n2,methods='Fisher')
time.fr <- proc.time()-ptm
exact_fragility[i,] <-c(out.fr$FI[[1]], time.fr[[1]])
print('done fragility')
# fragilitytools
ptm <- proc.time()
out.frt <- bin.fi(mat, test='fisher', alg='exact')
time.frt <- proc.time()-ptm
exact_fragilitytools[i,] <-c(out.frt$FI[[1]], time.frt[[1]])
}
sum(exact_fragility[,1]!=abs(exact_fragilitytools[,1]))
plot(exact_fragilitytools[,2], exact_fragility[,2]-exact_fragilitytools[,2])
ggplot2::qplot((exact_fragilitytools[,2]-exact_fragility[,2])/exact_fragility[,2])
summary(exact_fragility[,2]-exact_fragilitytools[,2])
devtools::load_all()
library(fragility)
p1 <- .1
p2 <- .4
En1 <- 1000
En2 <- 1000
niters <- 100
exact_fragility <- matrix(nrow=niters,ncol=2)
exact_fragilitytools <- matrix(nrow=niters,ncol=2)
for (i in 1:niters) {
n1 <- rpois(1,En1)
n2 <- rpois(1,En2)
x <- rbinom(1, n1, p1)
y <- rbinom(1, n2, p2)
mat <- matrix(nrow=2, c(x,y,n1-x,n2-y), dimnames=list(1:2,1:2))
# fragility
ptm <- proc.time()
out.fr <- fragility::frag.study(x,n1,y,n2,methods='Fisher')
time.fr <- proc.time()-ptm
exact_fragility[i,] <-c(out.fr$FI[[1]], time.fr[[1]])
print(paste0(i,': done fragility'))
# fragilitytools
ptm <- proc.time()
out.frt <- bin.fi(mat, test='fisher', alg='exact')
time.frt <- proc.time()-ptm
exact_fragilitytools[i,] <-c(out.frt$FI[[1]], time.frt[[1]])
print(paste0(i,': done fragilityTools'))
}
sum(exact_fragility[,1]!=abs(exact_fragilitytools[,1]))
plot(exact_fragilitytools[,2], exact_fragility[,2]-exact_fragilitytools[,2])
ggplot2::qplot((exact_fragilitytools[,2]-exact_fragility[,2])/exact_fragility[,2])
summary(exact_fragility[,2]-exact_fragilitytools[,2])
cbind(exact_fragility, exact_fragilitytools)
backup <- cbind(exact_fragility, exact_fragilitytools)
devtools::load_all()
library(fragility)
p1 <- .1
p2 <- .4
En1 <- 1000
En2 <- 1000
niters <- 100
exact_fragility <- matrix(nrow=niters,ncol=2)
exact_fragilitytools <- matrix(nrow=niters,ncol=2)
for (i in 1:niters) {
n1 <- rpois(1,En1)
n2 <- rpois(1,En2)
x <- rbinom(1, n1, p1)
y <- rbinom(1, n2, p2)
mat <- matrix(nrow=2, c(x,y,n1-x,n2-y), dimnames=list(1:2,1:2))
# fragility
ptm <- proc.time()
out.fr <- fragility::frag.study(x,n1,y,n2,methods='Fisher')
time.fr <- proc.time()-ptm
exact_fragility[i,] <-c(out.fr$FI[[1]], time.fr[[1]])
print(paste0(i,': done fragility'))
# fragilitytools
ptm <- proc.time()
out.frt <- bin.fi(mat, test='fisher', alg='exact')
time.frt <- proc.time()-ptm
exact_fragilitytools[i,] <-c(out.frt$FI[[1]], time.frt[[1]])
print(paste0(i,': done fragilityTools'))
}
sum(exact_fragility[,1]!=abs(exact_fragilitytools[,1]))
plot(exact_fragilitytools[,2], exact_fragility[,2]-exact_fragilitytools[,2])
ggplot2::qplot((exact_fragilitytools[,2]-exact_fragility[,2])/exact_fragility[,2])
summary(exact_fragility[,2]-exact_fragilitytools[,2])
backup
backup[84:100,]<-cbind(exact_fragility,exact_fragilitytools)
backup[84:100,]<-cbind(exact_fragility,exact_fragilitytools)[1:17,]
backup
exact_fragility <- backup[,1:2]
exact_fragilitytools <- backup[,3:4]
sum(exact_fragility[,1]!=abs(exact_fragilitytools[,1]))
plot(exact_fragilitytools[,2], exact_fragility[,2]-exact_fragilitytools[,2])
plot(exact_fragilitytools[,2], (exact_fragility[,2]-exact_fragilitytools[,2])/exact_fragilitytools[,2])
ggplot2::qplot((exact_fragilitytools[,2]-exact_fragility[,2])/exact_fragility[,2])
ggplot2::qplot((exact_fragility[,2]-exact_fragilitytools[,2])/exact_fragilitytools[,2])
ggplot2::qplot((exact_fragility[,2]-exact_fragilitytools[,2])/exact_fragilitytools[,2],bins=10)
summary(exact_fragility[,2]-exact_fragilitytools[,2])
summary((exact_fragility[,2]-exact_fragilitytools[,2])/exact_fragilitytools[,2])
summary(exact_fragilitytools)
backup
fisher.test(mat)$p.value
save.image("~/Documents/GitHub/p.1.4n1000backup.RData")
devtools::load_all()
library(fragility)
p1 <- .1
p2 <- .5
En1 <- 200
En2 <- 200
niters <- 100
exact_fragility <- matrix(nrow=niters,ncol=2)
exact_fragilitytools <- matrix(nrow=niters,ncol=2)
for (i in 1:niters) {
n1 <- rpois(1,En1)
n2 <- rpois(1,En2)
x <- rbinom(1, n1, p1)
y <- rbinom(1, n2, p2)
mat <- matrix(nrow=2, c(x,y,n1-x,n2-y), dimnames=list(1:2,1:2))
# fragility
ptm <- proc.time()
out.fr <- fragility::frag.study(x,n1,y,n2,methods='Fisher')
time.fr <- proc.time()-ptm
exact_fragility[i,] <-c(out.fr$FI[[1]], time.fr[[1]])
print(paste0(i,': done fragility'))
# fragilitytools
ptm <- proc.time()
out.frt <- bin.fi(mat, test='fisher', alg='exact')
time.frt <- proc.time()-ptm
exact_fragilitytools[i,] <-c(out.frt$FI[[1]], time.frt[[1]])
print(paste0(i,': done fragilityTools'))
}
sum(exact_fragility[,1]!=abs(exact_fragilitytools[,1]))
plot(exact_fragilitytools[,2], (exact_fragility[,2]-exact_fragilitytools[,2])/exact_fragilitytools[,2])
ggplot2::qplot((exact_fragility[,2]-exact_fragilitytools[,2])/exact_fragilitytools[,2],bins=10)
summary((exact_fragility[,2]-exact_fragilitytools[,2])/exact_fragilitytools[,2])
summary(exact_fragilitytools)
devtools::load_all()
library(fragility)
p1 <- .1
p2 <- .15
En1 <- 200
En2 <- 200
niters <- 100
exact_fragility <- matrix(nrow=niters,ncol=2)
exact_fragilitytools <- matrix(nrow=niters,ncol=2)
for (i in 1:niters) {
n1 <- rpois(1,En1)
n2 <- rpois(1,En2)
x <- rbinom(1, n1, p1)
y <- rbinom(1, n2, p2)
mat <- matrix(nrow=2, c(x,y,n1-x,n2-y), dimnames=list(1:2,1:2))
# fragility
ptm <- proc.time()
out.fr <- fragility::frag.study(x,n1,y,n2,methods='Fisher')
time.fr <- proc.time()-ptm
exact_fragility[i,] <-c(out.fr$FI[[1]], time.fr[[1]])
print(paste0(i,': done fragility'))
# fragilitytools
ptm <- proc.time()
out.frt <- bin.fi(mat, test='fisher', alg='exact')
time.frt <- proc.time()-ptm
exact_fragilitytools[i,] <-c(out.frt$FI[[1]], time.frt[[1]])
print(paste0(i,': done fragilityTools'))
}
sum(exact_fragility[,1]!=abs(exact_fragilitytools[,1]))
plot(exact_fragilitytools[,2], (exact_fragility[,2]-exact_fragilitytools[,2])/exact_fragilitytools[,2])
ggplot2::qplot((exact_fragility[,2]-exact_fragilitytools[,2])/exact_fragilitytools[,2],bins=10)
summary((exact_fragility[,2]-exact_fragilitytools[,2])/exact_fragilitytools[,2])
summary(exact_fragilitytools)
qplot(exact_fragility[,1])
devtools::load_all()
library(fragility)
p1 <- .1
p2 <- .15
En1 <- 100
En2 <- 100
niters <- 100
exact_fragility <- matrix(nrow=niters,ncol=2)
exact_fragilitytools <- matrix(nrow=niters,ncol=2)
for (i in 1:niters) {
n1 <- rpois(1,En1)
n2 <- rpois(1,En2)
x <- rbinom(1, n1, p1)
y <- rbinom(1, n2, p2)
mat <- matrix(nrow=2, c(x,y,n1-x,n2-y), dimnames=list(1:2,1:2))
# fragility
ptm <- proc.time()
out.fr <- fragility::frag.study(x,n1,y,n2,methods='Fisher')
time.fr <- proc.time()-ptm
exact_fragility[i,] <-c(out.fr$FI[[1]], time.fr[[1]])
print(paste0(i,': done fragility'))
# fragilitytools
ptm <- proc.time()
out.frt <- bin.fi(mat, test='fisher', alg='exact')
time.frt <- proc.time()-ptm
exact_fragilitytools[i,] <-c(out.frt$FI[[1]], time.frt[[1]])
print(paste0(i,': done fragilityTools'))
}
sum(exact_fragility[,1]!=abs(exact_fragilitytools[,1]))
plot(exact_fragilitytools[,2], (exact_fragility[,2]-exact_fragilitytools[,2])/exact_fragilitytools[,2])
ggplot2::qplot((exact_fragility[,2]-exact_fragilitytools[,2])/exact_fragilitytools[,2],bins=10)
summary((exact_fragility[,2]-exact_fragilitytools[,2])/exact_fragilitytools[,2])
summary(exact_fragilitytools)
qplot(exact_fragility[,1])
backup
exact_fragility <- backup[,1:2]
exact_fragilitytools <- backup[,3:4]
dev.off()
sum(exact_fragility[,1]!=abs(exact_fragilitytools[,1]))
l
plot(exact_fragilitytools[,2], (exact_fragility[,2]-exact_fragilitytools[,2])/exact_fragilitytools[,2])
ggplot2::qplot((exact_fragility[,2]-exact_fragilitytools[,2])/exact_fragilitytools[,2],bins=10)
summary((exact_fragility[,2]-exact_fragilitytools[,2])/exact_fragilitytools[,2])
summary(exact_fragilitytools[,2])
summary(exact_fragility[,2])
summary((exact_fragility[,2]-exact_fragilitytools[,2])/exact_fragilitytools[,2])
summary(exact_fragilitytools)
devtools::load_all()
library(fragility)
p1 <- .1
p2 <- .15
En1 <- 500
En2 <- 500
niters <- 1000
exact_fragility <- matrix(nrow=niters,ncol=2)
exact_fragilitytools <- matrix(nrow=niters,ncol=2)
for (i in 1:niters) {
n1 <- rpois(1,En1)
n2 <- rpois(1,En2)
x <- rbinom(1, n1, p1)
y <- rbinom(1, n2, p2)
mat <- matrix(nrow=2, c(x,y,n1-x,n2-y), dimnames=list(1:2,1:2))
# fragility
ptm <- proc.time()
out.fr <- fragility::frag.study(x,n1,y,n2,methods='Fisher')
time.fr <- proc.time()-ptm
exact_fragility[i,] <-c(out.fr$FI[[1]], time.fr[[1]])
print(paste0(i,': done fragility'))
# fragilitytools
ptm <- proc.time()
out.frt <- bin.fi(mat, test='fisher', alg='exact')
time.frt <- proc.time()-ptm
exact_fragilitytools[i,] <-c(out.frt$FI[[1]], time.frt[[1]])
print(paste0(i,': done fragilityTools'))
}
sum(exact_fragility[,1]!=abs(exact_fragilitytools[,1]))
summary(exact_fragility)
devtools::load_all()
library(fragility)
p1 <- .1
p2 <- .15
En1 <- 100
En2 <- 100
niters <- 1000
exact_fragility <- matrix(nrow=niters,ncol=2)
exact_fragilitytools <- matrix(nrow=niters,ncol=2)
for (i in 1:niters) {
n1 <- rpois(1,En1)
n2 <- rpois(1,En2)
x <- rbinom(1, n1, p1)
y <- rbinom(1, n2, p2)
mat <- matrix(nrow=2, c(x,y,n1-x,n2-y), dimnames=list(1:2,1:2))
# fragility
ptm <- proc.time()
out.fr <- fragility::frag.study(x,n1,y,n2,methods='Fisher')
time.fr <- proc.time()-ptm
exact_fragility[i,] <-c(out.fr$FI[[1]], time.fr[[1]])
print(paste0(i,': done fragility'))
# fragilitytools
ptm <- proc.time()
out.frt <- bin.fi(mat, test='fisher', alg='exact')
time.frt <- proc.time()-ptm
exact_fragilitytools[i,] <-c(out.frt$FI[[1]], time.frt[[1]])
print(paste0(i,': done fragilityTools'))
}
# exact_fragility <- backup[,1:2]
# exact_fragilitytools <- backup[,3:4]
sum(exact_fragility[,1]!=abs(exact_fragilitytools[,1]))
summary(exact_fragility[,1])
summary(exact_fragilitytools[,1])
summary(exact_fragilitytools)
summary(exact_fragility)
plot(exact_fragilitytools[,2], (exact_fragility[,2]-exact_fragilitytools[,2])/exact_fragilitytools[,2])
ggplot2::qplot((exact_fragility[,2]-exact_fragilitytools[,2])/exact_fragilitytools[,2],bins=10)
summary((exact_fragility[,2]-exact_fragilitytools[,2])/exact_fragilitytools[,2])
summary(backup[,4]/backup[,2])
summary(backup[,2]/backup[,4])
